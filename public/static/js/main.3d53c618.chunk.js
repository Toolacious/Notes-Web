(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{1367:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),i=n.n(r),c=n(36),s=n.n(c),o=(n(516),n(30)),l=n.n(o),d=n(49),u=n(10),j=(n(518),n(44)),p=n(1436),b=n(1413),m=n(1411),h=n(1427),x=n(76),O=n(1410),g=n(1428),f=n(257),v=n.n(f),w=n(199),y=n(1409),k=n(261),C=n(85),S=n(40),F=n(39),N=n(160),E=n.n(N);function I(){const e=Object(F.a)(["\n    mutation login($email: String!, $password: String!) {\n        login(data: { email: $email, password: $password }) {\n            userId\n            name\n            email\n            accessToken\n        }\n    }\n"]);return I=function(){return e},e}const T=E()(I());var W=n(21),B=n(158),$=n.n(B);let D="";const R=e=>{D=e},P=()=>D,z={user:null};if(P()){const e=$()(P());z.user=e}const A=Object(r.createContext)({user:null,login:e=>{},logout:()=>{}});function L(e,t){switch(t.type){case"LOGIN":return Object(W.a)(Object(W.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(W.a)(Object(W.a)({},e),{},{user:null});default:return e}}function q(e){const t=Object(r.useReducer)(L,z),n=Object(u.a)(t,2),i=n[0],c=n[1];return Object(a.jsx)(A.Provider,Object(W.a)({value:{user:i.user,login:function(e){c({type:"LOGIN",payload:e})},logout:function(){c({type:"LOGOUT"})}}},e))}var M=n(1370),G=n.p+"static/media/login.71966ff7.jpg";function U(){return Object(a.jsxs)(w.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(a.jsx)(x.b,{color:"inherit",to:"https://material-ui.com/",children:"Abyss Notes"})," ",(new Date).getFullYear(),"."]})}const Y=Object(y.a)((e=>({root:{height:"100vh"},image:{backgroundImage:"url(".concat(G,")"),backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}})));function _(){const e=Object(r.useContext)(A),t=Y(),n=Object(S.a)(T),i=Object(u.a)(n,2),c=i[0],s=i[1],o=(s.loading,s.error,Object(r.useState)("")),f=Object(u.a)(o,2),y=f[0],F=f[1],N=Object(j.g)(),E=C.a({email:C.c("Enter your email").email("Enter a valid email").required("Email is required"),password:C.c("").min(6,"Password must contain at least 6 characters").required("Enter your password")}),I=Object(k.a)({initialValues:{email:"",password:""},validationSchema:E,onSubmit:function(){var t=Object(d.a)(l.a.mark((function t(n){var a,r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=n.email,r=n.password,t.next=4,c({variables:{email:a,password:r}});case 4:(i=t.sent)&&i.data&&R(i.data.login.accessToken),e.login(i.data.login),N.push("/dashboard"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0.message),F(t.t0.message.slice(15));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()});return Object(a.jsxs)(O.a,{container:!0,component:"main",className:t.root,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(O.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),Object(a.jsx)(O.a,{item:!0,xs:12,sm:8,md:5,component:M.a,elevation:6,square:!0,children:Object(a.jsxs)("div",{className:t.paper,children:[Object(a.jsx)(p.a,{className:t.avatar,children:Object(a.jsx)(v.a,{})}),Object(a.jsx)(w.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(a.jsxs)("form",{className:t.form,onSubmit:I.handleSubmit,noValidate:!0,children:[Object(a.jsx)(h.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:I.values.email,onChange:I.handleChange,error:I.touched.email&&Boolean(I.errors.email)||"E"===y[0]||"e"===y[1],helperText:I.touched.email&&I.errors.email||("E"===y[0]||"e"===y[1]?y:null)}),Object(a.jsx)(h.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:I.handleChange,error:I.touched.password&&Boolean(I.errors.password)||"P"===y[0],helperText:I.touched.password&&I.errors.password||("P"===y[0]?y:null)}),Object(a.jsx)(b.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,disabled:I.isSubmitting,children:"Sign In"}),Object(a.jsx)(O.a,{container:!0,children:Object(a.jsx)(O.a,{item:!0,xs:!0,children:Object(a.jsx)(x.b,{to:"/signup",variant:"body2",children:"Don't have an account? Sign Up"})})}),Object(a.jsx)(g.a,{mt:5,children:Object(a.jsx)(U,{})})]})]})})]})}var K=n(1414);function V(){const e=Object(F.a)(["\n    mutation createUser(\n        $fname: String!\n        $lname: String!\n        $name: String!\n        $email: String!\n        $password: String!\n    ) {\n        createUser(\n            data: {\n                fname: $fname\n                lname: $lname\n                name: $name\n                email: $email\n                password: $password\n            }\n        ) {\n            id\n            name\n            password\n        }\n    }\n"]);return V=function(){return e},e}const H=E()(V());var J=n.p+"static/media/signup.e3594763.jpg";function Q(){return Object(a.jsxs)(w.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(a.jsx)(x.b,{color:"inherit",to:"https://material-ui.com/",children:"Abyss Notes"})," ",(new Date).getFullYear(),"."]})}const X=Object(y.a)((e=>({paper:{display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"white",padding:e.spacing(2),borderRadius:"20px"},image:{backgroundImage:"url(".concat(J,")"),backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)},space:{height:e.spacing(8)}})));function Z(){const e=Object(r.useContext)(A),t=C.a({fname:C.c("Enter your first name").min(2,"Fist name should be of minimum 2 characters length").max(50).required("First name is required"),lname:C.c("Enter your last name").min(2,"Fist name should be of minimum 2 characters length").required("Last name is required"),name:C.c("Enter a name").min(6,"Username should be of minimum 6 characters length").required("Name is required"),email:C.c("Enter your email").email("Enter a valid email").required("Email is required"),password:C.c("").min(6,"Password must contain at least 6 characters").required("Enter your password"),confirmPassword:C.c("Enter your password").required("Confirm your password").oneOf([C.b("password")],"Password does not match")}),n=Object(j.g)(),i=Object(S.a)(H),c=Object(u.a)(i,1)[0],s=Object(r.useState)(""),o=Object(u.a)(s,2),f=o[0],y=o[1],F=Object(S.a)(T),N=Object(u.a)(F,2),E=N[0],I=(N[1].loading,X()),W=Object(k.a)({initialValues:{fname:"",lname:"",name:"",email:"",password:"",confirmPassword:""},validationSchema:t,onSubmit:function(){var t=Object(d.a)(l.a.mark((function t(a){var r,i,s,o,d,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=a.fname,i=a.lname,s=a.name,o=a.email,d=a.password,t.next=4,c({variables:{fname:r,lname:i,name:s,email:o,password:d}});case 4:return t.next=6,E({variables:{email:o,password:d}});case 6:(u=t.sent)&&u.data&&R(u.data.login.accessToken),e.login(u.data.login),n.push("/dashboard"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0.message),y(t.t0.message.slice(15));case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()});return Object(a.jsx)("div",{style:{width:"100vw",height:"100vh"},className:I.image,children:Object(a.jsxs)(K.a,{component:"main",maxWidth:"xs",style:{height:"100%"},children:[Object(a.jsx)(m.a,{}),Object(a.jsx)("div",{className:I.space}),Object(a.jsxs)("div",{className:I.paper,children:[Object(a.jsx)(p.a,{className:I.avatar,children:Object(a.jsx)(v.a,{})}),Object(a.jsx)(w.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(a.jsxs)("form",{className:I.form,onSubmit:W.handleSubmit,noValidate:!0,children:[Object(a.jsxs)(O.a,{container:!0,spacing:2,children:[Object(a.jsx)(O.a,{item:!0,xs:12,sm:6,children:Object(a.jsx)(h.a,{autoComplete:"fname",name:"fname",variant:"outlined",required:!0,fullWidth:!0,id:"fname",label:"First name",autoFocus:!0,value:W.values.fname,onChange:W.handleChange,error:W.touched.fname&&Boolean(W.errors.fname),helperText:W.touched.fname&&W.errors.fname})}),Object(a.jsx)(O.a,{item:!0,xs:12,sm:6,children:Object(a.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,id:"lname",label:"Last name",name:"lname",autoComplete:"lname",value:W.values.lname,onChange:W.handleChange,error:W.touched.lname&&Boolean(W.errors.lname),helperText:W.touched.lname&&W.errors.lname})}),Object(a.jsx)(O.a,{item:!0,xs:12,children:Object(a.jsx)(h.a,{autoComplete:"username",name:"name",variant:"outlined",required:!0,fullWidth:!0,id:"name",label:"Username",autoFocus:!0,value:W.values.name,onChange:W.handleChange,error:W.touched.name&&Boolean(W.errors.name),helperText:W.touched.name&&W.errors.name})}),Object(a.jsx)(O.a,{item:!0,xs:12,children:Object(a.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",value:W.values.email,onChange:W.handleChange,error:W.touched.email&&Boolean(W.errors.email)||""!==f,helperText:W.touched.email&&W.errors.email||f})}),Object(a.jsx)(O.a,{item:!0,xs:12,children:Object(a.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:W.handleChange,error:W.touched.password&&Boolean(W.errors.password),helperText:W.touched.password&&W.errors.password})}),Object(a.jsx)(O.a,{item:!0,xs:12,children:Object(a.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"confirmPassword",autoComplete:"current-password",onChange:W.handleChange,error:W.touched.confirmPassword&&Boolean(W.errors.confirmPassword),helperText:W.touched.confirmPassword&&W.errors.confirmPassword})})]}),Object(a.jsx)(b.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:I.submit,disabled:W.isSubmitting,children:"Sign Up"}),Object(a.jsx)(O.a,{container:!0,justify:"flex-end",children:Object(a.jsx)(O.a,{item:!0,xs:!0,children:Object(a.jsx)(x.b,{to:"/login",variant:"body2",children:"Already have an account? Sign in"})})})]})]}),Object(a.jsx)(g.a,{mt:5,children:Object(a.jsx)(Q,{})})]})})}var ee=n(262);var te=function(e){let t=e.component,n=Object(ee.a)(e,["component"]);const i=Object(r.useContext)(A).user;return Object(a.jsx)(j.b,Object(W.a)(Object(W.a)({},n),{},{render:e=>i?Object(a.jsx)(j.a,{to:"/dashboard"}):Object(a.jsx)(t,Object(W.a)({},e))}))};var ne=function(e){let t=e.component,n=Object(ee.a)(e,["component"]);const i=Object(r.useContext)(A).user;return Object(a.jsx)(j.b,Object(W.a)(Object(W.a)({},n),{},{render:e=>i?Object(a.jsx)(t,Object(W.a)({},e)):Object(a.jsx)(j.a,{to:"/"})}))},ae=n(1420),re=n(1421),ie=n(467),ce=n.n(ie),se=n(7),oe=n(488),le=n(1415);const de=Object(y.a)((e=>({menubarButton:{fontSize:"14px",paddingTop:"0px",paddingBottom:"0px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),flexShrink:0,textTransform:"none"},menuItem:{fontSize:"14px",width:"128px"},disabledMenuItem:{cursor:"default",color:"rgb(180, 180, 180)!important",backgroundColor:"white!important"}})));function ue(e){const t=de(),n=e.menu,r=n.name,c=n.sections,s=i.a.useState(null),o=Object(u.a)(s,2),l=o[0],d=o[1];return Object(a.jsxs)("div",{children:[Object(a.jsx)(b.a,{className:t.menubarButton,"aria-controls":"name","aria-haspopup":"true",onClick:e=>{d(e.currentTarget)},onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},children:r}),Object(a.jsx)(oe.a,{id:"name",anchorEl:l,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},keepMounted:!0,open:Boolean(l),onClose:()=>{d(null)},children:c.map((e=>Object(a.jsx)(le.a,{className:Object(se.a)(t.menuItem,{[t.disabledMenuItem]:"Save"===e.name&&!document.getElementById("saveMain")}),onClick:()=>{e.func(),d(null)},children:e.name})))})]})}var je=n(1417),pe=n(1416);function be(){const e=Object(F.a)(["\n    mutation {\n        logout\n    }\n"]);return be=function(){return e},e}const me=E()(be());var he=n(466),xe=n.n(he);n(626);function Oe(){const e=Object(F.a)(["\n    mutation upload($id: String!, $picture: String!) {\n        upload(id: $id, picture: $picture)\n    }\n"]);return Oe=function(){return e},e}const ge=E()(Oe());var fe=n(1418);const ve=Object(r.createContext)({avatar:String,setAvatar:()=>{}});function we(){return(we=Object(d.a)(l.a.mark((function e(t,n,a,r,i){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n&&t){e.next=3;break}return e.abrupt("return");case 3:return c=t.toDataURL("image/png"),e.next=6,a({variables:{id:r,picture:c}});case 6:i(c),e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}const ye=Object(y.a)((e=>({root:{width:"60vw",height:"60vh",padding:e.spacing(0,3)},dialogButtonWrapper:{display:"flex",width:"50%",flexGrow:1},dialogButton:{display:"flex",width:"100%",fontSize:"18px",textTransform:"none",textAlign:"center"},dialog:{},input:{display:"none"}})));function ke(e){var t,n;const i=ye(),c=e.onClose,s=e.open,o=Object(r.useContext)(A).user.userId,l=Object(r.useContext)(ve).setAvatar,d=Object(S.a)(ge),j=Object(u.a)(d,1)[0],p=Object(r.useState)(),m=Object(u.a)(p,2),h=m[0],x=m[1],O=Object(r.useRef)(null),g=Object(r.useRef)(null),f=Object(r.useState)({width:50,height:50,aspect:1}),v=Object(u.a)(f,2),w=v[0],y=v[1],k=Object(r.useState)(null),C=Object(u.a)(k,2),F=C[0],N=C[1],E=Object(r.useCallback)((e=>{O.current=e}),[]);return Object(r.useEffect)((()=>{if(!F||!g.current||!O.current)return;const e=O.current,t=g.current,n=F,a=e.naturalWidth/e.width,r=e.naturalHeight/e.height,i=t.getContext("2d"),c=window.devicePixelRatio;t.width=n.width*c,t.height=n.height*c,i.setTransform(c,0,0,c,0,0),i.imageSmoothingQuality="high",i.drawImage(e,n.x*a,n.y*r,n.width*a,n.height*r,0,0,n.width,n.height)}),[F]),Object(a.jsxs)(pe.a,{maxWidth:"xl",open:s,onClose:c,"aria-labelledby":"avatarUpload",children:[Object(a.jsx)(je.a,{id:"avatarUpload",children:"Upload Avatar"}),Object(a.jsxs)("div",{className:i.root,children:[Object(a.jsx)(xe.a,{src:h,onImageLoaded:E,crop:w,onChange:e=>y(e),onComplete:e=>N(e),circularCrop:!0,style:{maxHeight:"100%",maxWidth:"100%",overflow:"auto"}}),Object(a.jsx)("div",{children:Object(a.jsx)("canvas",{ref:g,style:{width:Math.round(null!==(t=null===F||void 0===F?void 0:F.width)&&void 0!==t?t:0),height:Math.round(null!==(n=null===F||void 0===F?void 0:F.height)&&void 0!==n?n:0),display:"none"}})})]}),Object(a.jsxs)(fe.a,{children:[Object(a.jsx)("input",{accept:"image/*",className:i.input,id:"contained-button-file",type:"file",onChange:e=>{if(e.target.files&&e.target.files.length>0){const t=new FileReader;t.addEventListener("load",(()=>x(t.result))),t.readAsDataURL(e.target.files[0])}}}),Object(a.jsx)("label",{htmlFor:"contained-button-file",className:i.dialogButtonWrapper,children:Object(a.jsx)(b.a,{className:i.dialogButton,onClick:()=>{},color:"primary",component:"span",children:"Upload"})}),Object(a.jsx)("div",{className:i.dialogButtonWrapper,children:Object(a.jsx)(b.a,{className:i.dialogButton,disabled:!(null===F||void 0===F?void 0:F.width)||!(null===F||void 0===F?void 0:F.height),onClick:()=>{!function(e,t,n,a,r){we.apply(this,arguments)}(g.current,F,j,o,l),c()},color:"primary",children:"Save"})})]})]})}const Ce=Object(y.a)((e=>({avatar:{height:"128px",width:"128px",borderRadius:"50%"},headerAvatar:{height:"48px",width:"48px",marginLeft:e.spacing(1),marginRight:e.spacing(1),borderRadius:"50%"},headerAvatarWrapper:{display:"flex",justifyContent:"center",alignItems:"center"},avatarWrapper:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:e.spacing(3)},dialogButton:{width:"256px",fontSize:"18px",textTransform:"none"},dialog:{}})));function Se(e){const t=Ce(),n=Object(r.useContext)(A),i=Object(j.g)(),c=Object(S.a)(me),s=Object(u.a)(c,1)[0],o=e.onClose,p=e.onOpen,m=e.selectedValue,h=e.open,x=e.avatar_src;return Object(a.jsxs)(pe.a,{className:t.dialog,onClose:()=>{o(m)},"aria-labelledby":"account-dialog-title",open:h,children:[Object(a.jsx)(je.a,{id:"account-dialog-title",children:"Account"}),Object(a.jsx)("div",{className:t.avatarWrapper,children:Object(a.jsx)("img",{className:t.avatar,src:x,alt:"avatar"})}),Object(a.jsx)(b.a,{onClick:p,className:t.dialogButton,children:"Change avatar"}),Object(a.jsx)(b.a,{className:t.dialogButton,onClick:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,s();case 3:R(""),P()||(i.push("/"),n.logout());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:"Log out"})]})}function Fe(e){const t=Ce(),n=i.a.useState(!1),r=Object(u.a)(n,2),c=r[0],s=r[1],o=i.a.useState(!1),l=Object(u.a)(o,2),d=l[0],j=l[1],p=i.a.useState(0),b=Object(u.a)(p,2),m=b[0],h=b[1],x=()=>{s(!0)},O=e=>{s(!1),h(e)};return Object(a.jsxs)("div",{className:t.headerAvatarWrapper,children:[Object(a.jsx)("img",{className:t.headerAvatar,src:e.src,alt:"#",onClick:x}),Object(a.jsx)(Se,{selectedValue:m,open:c,onClose:O,onOpen:()=>{O(),j(!0)},avatar_src:e.src}),Object(a.jsx)(ke,{open:d,onClose:()=>{j(!1),x()}})]})}const Ne=Object(r.createContext)({usernotes:[],openFiles:[],currentOpenFile:"",setcurrentOpenFile:e=>{},setuserNotes:e=>{},setopenFiles:e=>{},actions:null});var Ee=n(1419);const Ie=Object(y.a)((()=>({dialogButton:{width:"256px",fontSize:"18px",textTransform:"none"},dialog:{}})));function Te(e){Ie();const t=Object(r.useContext)(Ne),n=t.usernotes,c=t.actions,s=i.a.useState(""),o=Object(u.a)(s,2),l=o[0],d=o[1],j=i.a.useState(!0),p=Object(u.a)(j,2),m=p[0],x=p[1],O=i.a.useState(""),g=Object(u.a)(O,2),f=g[0],v=g[1],w=()=>l?-1!==n.findIndex((e=>e.title===l))?(x(!1),void v("name existed!")):(c.new(l),void e.closeFunc()):(x(!1),void v("empty name!"));return Object(a.jsxs)(pe.a,{open:!0,"aria-labelledby":"name-dialog-title",children:[Object(a.jsx)(je.a,{id:"name-dialog-title",children:"File name"}),Object(a.jsx)(Ee.a,{children:Object(a.jsx)(h.a,{autoFocus:!0,error:!m,helperText:m?"":f,margin:"dense",id:"createBox",label:"new name",fullWidth:!0,onChange:e=>{return t=e.target.value,d(t),void x(!0);var t},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),w())}})}),Object(a.jsxs)(fe.a,{children:[Object(a.jsx)(b.a,{onClick:e.closeFunc,color:"primary",children:"Cancel"}),Object(a.jsx)(b.a,{onClick:w,color:"primary",children:"OK"})]})]})}var We=n.p+"static/media/icon.e44a45f6.jpg",Be=n.p+"static/media/avatar.dae53026.jpg",$e=n.p+"static/media/title.b86a37ea.jpg";const De=Object(y.a)((e=>({headerWrapper:{display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"nowrap",borderBottom:"1px solid ".concat(e.palette.divider),zIndex:e.zIndex.drawer+1},icon:{height:"48px",width:"48px",marginLeft:e.spacing(1),marginRight:e.spacing(1),borderRadius:"50%"},mainWrapper:{display:"flex",flexDirection:"column",flexGrow:1},titlebar:{fontSize:"20px",height:"48px",border:"1px transparent"},titleImg:{maxHeight:"48px",objectFit:"contain"},menubar:{minHeight:"0px",padding:"0px",overflowX:"auto"}})));function Re(){const e=De(),t=i.a.useState(!1),n=Object(u.a)(t,2),c=n[0],s=n[1],o=Object(r.useContext)(ve).avatar,l={name:"File",sections:[{name:"New",func:()=>{s(!0)}},{name:"Save",func:()=>{let e=document.getElementById("saveMain");e&&e.click()}}]};return Object(a.jsx)(i.a.Fragment,{children:Object(a.jsxs)(g.a,{className:e.headerWrapper,children:[Object(a.jsx)("img",{className:e.icon,src:We,alt:"#"}),Object(a.jsxs)(g.a,{className:e.mainWrapper,children:[Object(a.jsx)("div",{className:e.titlebar,children:Object(a.jsx)("img",{src:$e,className:e.titleImg})}),Object(a.jsxs)(ae.a,{component:"nav",variant:"dense",className:e.menubar,children:[Object(a.jsx)(ue,{menu:l}),c?Object(a.jsx)(Te,{closeFunc:()=>{s(!1)}}):null]})]}),Object(a.jsx)(re.a,{style:{display:"none"},children:Object(a.jsx)(ce.a,{fontSize:"large"})}),Object(a.jsx)(Fe,{src:o||Be})]})})}var Pe=n(77),ze=n(1423),Ae=n(1433),Le=n(475),qe=n.n(Le),Me=n(474),Ge=n.n(Me),Ue=n(476),Ye=n.n(Ue);const _e=Object(y.a)((e=>({dialogButton:{width:"128px",fontSize:"18px",textTransform:"none"},dialog:{}})));function Ke(e){const t=_e(),n=e.func,r=n.updFunc,i=n.closeFunc;return Object(a.jsxs)(pe.a,{open:!0,"aria-labelledby":"save-dialog-title",children:[Object(a.jsx)(je.a,{id:"save-dialog-title",children:"Save File?"}),Object(a.jsxs)(fe.a,{children:[Object(a.jsx)(b.a,{className:t.dialogButton,onClick:r,color:"primary",children:"Yes"}),Object(a.jsx)(b.a,{className:t.dialogButton,onClick:i,color:"primary",children:"No"})]})]})}var Ve=n(468),He=n.n(Ve),Je=n(469),Qe=n.n(Je),Xe=n(330),Ze=n(1430),et=n(1422),tt=n(470),nt=n.n(tt);n(732);var at=e=>Object(a.jsx)(He.a,Object(W.a)({},(e=>Object(W.a)(Object(W.a)({},e),{},{escapeHtml:!1,plugins:[[nt.a,{singleTilde:!1}],Qe.a],renderers:Object(W.a)(Object(W.a)({},e.renderers),{},{code:({language:e,value:t})=>t?Object(a.jsx)(Ze.a,{style:et.a,language:e,children:t}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(a.Fragment,{children:"~~~"+e}),Object(a.jsx)("br",{}),Object(a.jsx)(a.Fragment,{children:"~~~"})]}),math:({value:e})=>Object(a.jsx)(Xe.BlockMath,{children:e}),inlineMath:({value:e})=>Object(a.jsx)(Xe.InlineMath,{children:e})})}))(e)));function rt(){const e=Object(F.a)(["\n    mutation updateNote(\n        $id: String!\n        $email: String!\n        $title: String\n        $markdown: String\n        $tags: [String]\n        $links: [String]\n    ) {\n        updateNote(\n            data: {\n                id: $id\n                email: $email\n                title: $title\n                markdown: $markdown\n                tags: $tags\n                links: $links\n            }\n        )\n    }\n"]);return rt=function(){return e},e}const it=E()(rt());var ct=n(264);const st=Object(r.createContext)({mode:ct.String,setMode:()=>{},open:Boolean,setOpen:()=>{},searchStr:ct.String,setSearchStr:()=>{},guide:ct.String}),ot=Object(y.a)((e=>({root:{display:"flex",flexDirection:"column",flexGrow:1},pageBar:{display:"flex",flexWrap:"wrap",alignItems:"center",listStyle:"none",margin:0,height:24,overflowY:"auto",backgroundColor:"#E0E0E0"},chip:{margin:"0px",borderRadius:"0px",borderRight:"2px solid ".concat(e.palette.divider),borderBottom:"1px solid ".concat(e.palette.divider)},chipRoot:{transform:"none","&:focus":{backgroundColor:"white"},"&:hover":{backgroundColor:e.palette.action.hover}},chipText:{width:e.spacing(12),textAlign:"left",overflow:"hidden",textOverflow:"ellipsis"},chipFocus:{backgroundColor:"white",borderBottom:"1px solid white!important","&:hover":{backgroundColor:"white"}},markdown:{padding:e.spacing(3,0)},mainWindowWrapper:{display:"flex",flexGrow:1,position:"relative"},mainWindow:{display:"flex",width:"50%",borderRadius:"0px",overflow:"auto"},viewWindow:{display:"flex",width:"50%",borderRadius:"0px",overflow:"auto"},modeButtonWrapper:{display:"flex",position:"absolute",top:e.spacing(1),right:e.spacing(2),borderRadius:"16px",border:"1px solid black",backgroundColor:"white"},nopad:{padding:"0px",margin:"0px 3px"},inputStyle:{width:"100%",height:"calc(100vh - 130px)",fontSize:"18px",padding:e.spacing(2,4),resize:"none",border:"none",outline:"none",overflow:"auto"},outputStyle:{width:"100%",height:"calc(100vh - 130px)",fontSize:"18px",textAlign:"left",backgroundColor:"white",padding:e.spacing(2,4),overflow:"auto"}})));function lt(){const e=Object(S.a)(it),t=Object(u.a)(e,1)[0],n=Object(r.useContext)(A).user.email,c=Object(r.useContext)(st).guide,s=ot(),o=Object(Pe.a)(),j=Object(r.useContext)(Ne),p=j.usernotes,b=j.openFiles,h=j.currentOpenFile,x=j.actions,O=i.a.useState("main"),g=Object(u.a)(O,2),f=g[0],v=g[1],w=i.a.useState(0),y=Object(u.a)(w,2),k=y[0],C=y[1],F=i.a.useState([]),N=Object(u.a)(F,2),E=N[0],I=N[1],T=i.a.useState(!1),W=Object(u.a)(T,2),B=W[0],$=W[1],D=i.a.useState({}),R=Object(u.a)(D,2),P=R[0],z=R[1];Object(r.useEffect)((()=>{if(b.length>k){let e=b[b.length-1];(e=>{I([...E,e]),C(k+1)})(Object.assign({unsaved:!1},p.find((t=>t.id===e))))}if(b.length<k){let e=E.findIndex((e=>!b.includes(e.id))),t=E.filter(((t,n)=>n!==e));I(t),C(k-1)}}),[b]);const L=e=>{let t=b.indexOf(e);E[t].unsaved?($(!0),z({updFunc:function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G(e);case 2:x.close(e),$(!1);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),closeFunc:()=>{x.close(e),$(!1)}})):x.close(e)},q=e=>{v(e)},G=function(){var e=Object(d.a)(l.a.mark((function e(a){var r,i,c,s,o,d,u,j,p,m,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.indexOf(a),i=E[r],c=i.id,s=i.title,o=i.markdown,d=i.tags,!i.unsaved){e.next=20;break}for(e.prev=3,u=/\[\[(\w*?)\]\]/gm,j=o,m=[];null!==(p=u.exec(j));)p.index===u.lastIndex&&u.lastIndex++,p.forEach(((e,t)=>{1===t&&m.push(e)}));return(h=[...E])[r].links=m,x.save(a,{id:c,title:s,markdown:o,tags:d,links:m}),h[r].unsaved=!1,I(h),e.next=15,t({variables:{id:c,email:n,markdown:o,links:m}});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:s.root,children:[Object(a.jsx)(m.a,{}),0===b.length?Object(a.jsx)("div",{className:s.mainWindowWrapper,children:Object(a.jsx)(at,{className:"input ".concat(s.outputStyle),children:c})}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:s.pageBar,children:[b.map(((e,t)=>Object(a.jsx)("li",{children:Object(a.jsx)(Ae.a,{size:"small",label:p.find((t=>t.id===e)).title,disableRipple:!0,onClick:t=>{x.open(e),document.getElementsByClassName("input")[0].focus()},onDelete:()=>L(e),className:Object(se.a)(s.chip,{[s.chipFocus]:e===h}),classes:{root:s.chipRoot,label:s.chipText}})},t))),Object(a.jsx)("div",{style:{flexGrow:1,height:24,borderBottom:"1px solid ".concat(o.palette.divider)}})]}),Object(a.jsxs)("div",{className:s.mainWindowWrapper,children:[Object(a.jsxs)("div",{className:s.modeButtonWrapper,children:[Object(a.jsx)(re.a,{color:"main"===f?"inherit":"default",onClick:()=>q("main"),classes:{root:s.nopad},disableRipple:!0,children:Object(a.jsx)(Ge.a,{})}),Object(a.jsx)(ze.a,{orientation:"vertical",style:{height:"24px",backgroundColor:"rgb(160, 160, 160)"}}),Object(a.jsx)(re.a,{color:"mix"===f?"inherit":"default",onClick:()=>q("mix"),classes:{root:s.nopad},disableRipple:!0,children:Object(a.jsx)(qe.a,{})}),k===b.length&&E[b.indexOf(h)].unsaved?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ze.a,{orientation:"vertical",style:{height:"24px",backgroundColor:"rgb(160, 160, 160)"}}),Object(a.jsx)(re.a,{id:"saveMain",onClick:()=>G(h),classes:{root:s.nopad},disableRipple:!0,children:Object(a.jsx)(Ye.a,{})})]}):null,B?Object(a.jsx)(Ke,{func:P}):null]}),"main"===f||"mix"===f?Object(a.jsx)(M.a,{elevation:0,className:s.mainWindow,style:"main"===f?{width:"100%"}:{},children:Object(a.jsx)("textarea",{autoFocus:!0,className:"input ".concat(s.inputStyle),value:k===b.length?E[b.indexOf(h)].markdown:"",onChange:e=>{(e=>{let t=b.indexOf(h),n=[...E];n[t].markdown=e,n[t].unsaved=!0,I(n)})(e.target.value)}})}):Object(a.jsx)(a.Fragment,{}),"mix"===f?Object(a.jsx)(ze.a,{orientation:"vertical"}):null,"view"===f||"mix"===f?Object(a.jsx)(M.a,{elevation:0,className:s.viewWindow,style:"view"===f?{width:"100%"}:{},children:Object(a.jsx)(at,{className:"input ".concat(s.outputStyle),children:k===b.length?E[b.indexOf(h)].markdown:""})}):Object(a.jsx)(a.Fragment,{})]})]})]})}function dt(){const e=Object(F.a)(["\n    query usernotes($email: String!) {\n        usernotes(email: $email) {\n            id\n            tags\n            links\n            markdown\n            title\n        }\n    }\n"]);return dt=function(){return e},e}const ut=E()(dt());function jt(){const e=Object(F.a)(["\n    query userAvatar($id: String!) {\n        userAvatar(id: $id)\n    }\n"]);return jt=function(){return e},e}const pt=E()(jt());function bt(){const e=Object(F.a)(["\n    query {\n        user\n    }\n"]);return bt=function(){return e},e}const mt=E()(bt());var ht=n(1432),xt=n(479),Ot=n.n(xt),gt=n(480),ft=n.n(gt),vt=n(481),wt=n.n(vt),yt=n(1412),kt=n(1371),Ct=n(1424),St=n(163),Ft=n.n(St),Nt=n(133),Et=n.n(Nt);const It=Object(y.a)((e=>({titlebar:{flexGrow:1,fontSize:"14px",margin:e.spacing(1),outline:"none",padding:"1px 6px",borderRadius:"12px",borderColor:"".concat(e.palette.divider),"&:focus":{borderColor:e.palette.text.primary}},linksIOTitle:{height:"28px",padding:e.spacing(2,0)}})));function Tt(){const e=It(),t=Object(r.useContext)(Ne),n=t.usernotes,i=t.actions,c=Object(r.useContext)(st),s=c.searchStr,o=c.setSearchStr,l=Object(r.useState)([]),d=Object(u.a)(l,2),j=d[0],p=d[1],b=Object(r.useState)([]),h=Object(u.a)(b,2),x=h[0],O=h[1],g=Object(r.useState)([]),f=Object(u.a)(g,2),v=f[0],w=f[1],y=Object(r.useState)(!1),k=Object(u.a)(y,2),C=k[0],S=k[1],F=Object(r.useState)(!1),N=Object(u.a)(F,2),E=N[0],I=N[1],T=()=>{document.getElementsByClassName("input")[0]&&document.getElementsByClassName("input")[0].focus()};return Object(r.useEffect)((()=>{if(s)if("tags:"===s.slice(0,5)){let e=[];n.forEach((t=>{let n=t.title,a=t.id,r=t.markdown;t.tags.forEach((t=>{t===s.slice(6)&&e.push({title:n,id:a,markdown:r})}))})),p(e)}else{let e=[],t=[];n.forEach((n=>{let a=n.title,r=n.id,i=n.markdown;n.title.includes(s)&&e.push({title:a,id:r,markdown:i}),n.markdown.includes(s)&&t.push({title:a,id:r,markdown:i})})),O(e),w(t)}else O([]),w([]);return()=>{}}),[s]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(m.a,{}),Object(a.jsx)("div",{style:{display:"flex"},children:Object(a.jsx)("input",{id:"searchbox",className:e.titlebar,placeholder:"Search files or tags",onChange:e=>{o(e.target.value)},value:s})}),Object(a.jsx)(ze.a,{style:{height:"3px"}}),Object(a.jsx)("div",{style:{flexGrow:1,overflowY:"auto"},children:Object(a.jsx)(yt.a,{disablePadding:!0,children:"tags:"===s.slice(0,5)?j.map(((e,t)=>Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(kt.a,{button:!0,onClick:()=>{i.open(e.id),T()},children:Object(a.jsx)(Ct.a,{primary:e.title})},t),Object(a.jsx)(ze.a,{})]}))):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(kt.a,{button:!0,onClick:()=>S(!C),className:e.linksIOTitle,children:[C?Object(a.jsx)(Ft.a,{}):Object(a.jsx)(Et.a,{}),Object(a.jsx)(Ct.a,{primary:"File"})]},"titleMatched"),Object(a.jsx)(ze.a,{}),C?x.map(((e,t)=>Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(kt.a,{button:!0,onClick:()=>{i.open(e.id),T()},children:Object(a.jsx)(Ct.a,{primary:e.title})},t),Object(a.jsx)(ze.a,{})]}))):null,Object(a.jsxs)(kt.a,{button:!0,onClick:()=>I(!E),className:e.linksIOTitle,children:[E?Object(a.jsx)(Ft.a,{}):Object(a.jsx)(Et.a,{}),Object(a.jsx)(Ct.a,{primary:"Content"})]},"mdMatched"),Object(a.jsx)(ze.a,{}),E?v.map(((e,t)=>Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(kt.a,{button:!0,onClick:()=>{i.open(e.id),T()},children:Object(a.jsx)(Ct.a,{primary:e.title})},t),Object(a.jsx)(ze.a,{})]}))):null]})})})]})}var Wt=n(1425),Bt=n(260),$t=n.n(Bt),Dt=n(1435),Rt=n(477),Pt=n.n(Rt),zt=n(478),At=n.n(zt);const Lt=Object(y.a)((()=>({dialogButton:{width:"256px",fontSize:"18px",textTransform:"none"},dialog:{}})));function qt(e){Lt();const t=Object(r.useContext)(Ne),n=t.usernotes,c=t.actions,s=i.a.useState(""),o=Object(u.a)(s,2),l=o[0],d=o[1],j=i.a.useState(!0),p=Object(u.a)(j,2),m=p[0],x=p[1],O=i.a.useState(""),g=Object(u.a)(O,2),f=g[0],v=g[1],w=()=>l?-1!==n.findIndex((e=>e.title===l))?(x(!1),void v("name existed!")):(c.rename(e.fileID,l),void e.closeFunc()):(x(!1),void v("empty name!"));return Object(a.jsxs)(pe.a,{open:!0,"aria-labelledby":"form-dialog-title_".concat(e.fileID),children:[Object(a.jsx)(je.a,{id:"form-dialog-title_".concat(e.fileID),children:"New name"}),Object(a.jsx)(Ee.a,{children:Object(a.jsx)(h.a,{autoFocus:!0,error:!m,helperText:m?"":f,margin:"dense",id:"renameBox_".concat(e.fileID),label:"new name",fullWidth:!0,onChange:e=>{return t=e.target.value,d(t),void x(!0);var t},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),w())}})}),Object(a.jsxs)(fe.a,{children:[Object(a.jsx)(b.a,{onClick:e.closeFunc,color:"primary",children:"Cancel"}),Object(a.jsx)(b.a,{onClick:w,color:"primary",children:"OK"})]})]})}const Mt=Object(y.a)((e=>({dialogButton:{width:"128px",fontSize:"18px",textTransform:"none"},dialog:{}})));function Gt(e){const t=Mt(),n=Object(r.useContext)(Ne).actions;return Object(a.jsxs)(pe.a,{open:!0,"aria-labelledby":"delete-dialog-title_".concat(e.fileID),children:[Object(a.jsx)(je.a,{id:"delete-dialog-title_".concat(e.fileID),children:"Delete ".concat(e.title,"?")}),Object(a.jsxs)(fe.a,{children:[Object(a.jsx)(b.a,{className:t.dialogButton,onClick:()=>{n.delete(e.fileID),e.closeFunc()},color:"primary",children:"Yes"}),Object(a.jsx)(b.a,{className:t.dialogButton,onClick:e.closeFunc,color:"primary",children:"No"})]})]})}const Ut=Object(y.a)((e=>({labelIcon:{marginRight:e.spacing(.5)},labelText:{textAlign:"left",fontSize:"16px",fontWeight:"inherit",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},menuItem:{fontSize:"14px",width:"128px"}})));function Yt(e){const t=Ut(),n=e.node,c=i.a.useState(null),s=Object(u.a)(c,2),o=s[0],l=s[1],d=i.a.useState(!1),j=Object(u.a)(d,2),p=j[0],b=j[1],m=i.a.useState(!1),h=Object(u.a)(m,2),x=h[0],O=h[1],g=Object(r.useContext)(Ne).actions,f=e=>{e.preventDefault(),l(e.currentTarget)};return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{onContextMenu:f,style:{display:"flex",alignItems:"center",position:"relative"},onClick:e=>{0===e.button?(g.open(n.id),document.getElementsByClassName("input")[0]&&document.getElementsByClassName("input")[0].focus()):2===e.button&&f()},children:["dir"===n.type?Object(a.jsx)(Pt.a,{fontSize:"small",className:t.labelIcon}):Object(a.jsx)(At.a,{fontSize:"small",className:t.labelIcon}),Object(a.jsx)(w.a,{className:t.labelText,children:n.title})]}),"dir"!==n.type?Object(a.jsxs)(oe.a,{id:"name",anchorEl:o,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},keepMounted:!0,open:Boolean(o),onClose:()=>{l(null)},autoFocus:!1,children:[Object(a.jsx)(le.a,{className:t.menuItem,onClick:()=>{b(!0),l(null)},onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},children:"Rename"}),Object(a.jsx)(le.a,{className:t.menuItem,onClick:()=>{O(!0),l(null)},children:"Delete"})]}):null,p?Object(a.jsx)(qt,{fileID:n.id,closeFunc:()=>b(!1)}):null,x?Object(a.jsx)(Gt,{fileID:n.id,title:n.title,closeFunc:()=>O(!1)}):null]})}const _t=Object(y.a)((e=>({root:{height:110,flexGrow:1,maxWidth:400,paddingTop:"6px"},labelIcon:{marginRight:e.spacing(.5)},labelText:{textAlign:"left",fontSize:"16px",fontWeight:"inherit",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},colorWhite1:{"&.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label":{backgroundColor:"white"}}})));function Kt(){const e=_t(),t=Object(r.useContext)(Ne),n=Object(r.useContext)(A),i=t=>Object(a.jsx)(Dt.a,{nodeId:t.id,label:Object(a.jsx)(Yt,{node:t}),classes:{root:e.colorWhite1},children:Array.isArray(t.usernotes)?t.usernotes.map((e=>i(e))):null},t.id);return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(Wt.a,{className:e.root,defaultCollapseIcon:Object(a.jsx)(Et.a,{}),defaultExpanded:["root"],defaultExpandIcon:Object(a.jsx)($t.a,{}),children:i(Object(W.a)(Object(W.a)({},t),{},{id:"root",title:n.user.name,type:"dir"}))})})}const Vt=Object(y.a)((e=>({root:{width:32,display:"flex"},sidebarWrapper:{width:32,display:"flex",alignItems:"center",flexDirection:"column",borderRight:"1px solid ".concat(e.palette.divider)},nopad:{padding:"0px",margin:"6px 0px"},rootShift:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:256},drawer:{flexShrink:0},drawerPaperWrapper:{position:"relative"},drawerPaper:{position:"absolute",top:"0px",right:32,width:256,bottom:"0px"}})));function Ht(){const e=Vt(),t=Object(r.useContext)(st),n=t.open,i=t.setOpen,c=t.mode,s=t.setMode,o=Object(r.useState)(!1),l=Object(u.a)(o,2),d=l[0],j=l[1],p=e=>{s(e),n||i(!0),n&&e===c&&i(!1)};return Object(a.jsxs)("div",{className:Object(se.a)(e.root,{[e.rootShift]:n}),children:[Object(a.jsx)(m.a,{}),Object(a.jsxs)("div",{className:e.sidebarWrapper,children:[Object(a.jsx)(re.a,{color:"search"===c&&n?"inherit":"default","aria-label":"open drawer",onClick:()=>p("search"),classes:{root:e.nopad},disableRipple:!0,children:Object(a.jsx)(Ot.a,{})}),Object(a.jsx)(re.a,{color:"file"===c&&n?"inherit":"default","aria-label":"open drawer",onClick:()=>p("file"),classes:{root:e.nopad},disableRipple:!0,children:Object(a.jsx)(ft.a,{})}),Object(a.jsx)(re.a,{color:d?"inherit":"default","aria-label":"open drawer",onClick:()=>{j(!d)},classes:{root:e.nopad},style:{display:"none"},disableRipple:!0,children:Object(a.jsx)(wt.a,{})})]}),Object(a.jsx)(ht.a,{className:e.drawer,variant:"persistent",anchor:"left",open:n,classes:{paper:e.drawerPaper,docked:e.drawerPaperWrapper},children:"search"===c?Object(a.jsx)(Tt,{}):Object(a.jsx)(Kt,{})})]})}var Jt=n(482),Qt=n.n(Jt),Xt=n(483),Zt=n.n(Xt),en=n(484),tn=n.n(en);const nn=Object(y.a)((e=>({root:{width:32,display:"flex"},sidebarWrapper:{width:32,display:"flex",alignItems:"center",flexDirection:"column",borderLeft:"1px solid ".concat(e.palette.divider)},nopad:{padding:"0px",margin:"6px 0px"},rootShift:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:256},drawer:{flexShrink:0},drawerPaperWrapper:{position:"relative"},drawerPaper:{position:"absolute",top:"0px",right:32,width:256,bottom:"0px"},drawerButton:{width:"36px",padding:"0px",margin:"6px 0px 6px 6px"},linksIOTitle:{height:"28px",padding:e.spacing(2,0)}})));function an(){const e=nn(),t=Object(r.useContext)(Ne),n=t.currentOpenFile,i=t.usernotes,c=t.actions,s=Object(r.useContext)(st),o=s.setSearchStr,l=s.setOpen,d=s.setMode,j=Object(r.useState)(!1),p=Object(u.a)(j,2),b=p[0],h=p[1],x=Object(r.useState)("link"),O=Object(u.a)(x,2),g=O[0],f=O[1],v=Object(r.useState)([]),w=Object(u.a)(v,2),y=w[0],k=w[1],C=Object(r.useState)([]),S=Object(u.a)(C,2),F=S[0],N=S[1],E=Object(r.useState)(!1),I=Object(u.a)(E,2),T=I[0],W=I[1],B=Object(r.useState)(!1),$=Object(u.a)(B,2),D=$[0],R=$[1];Object(r.useEffect)((()=>{try{if(n){let e=i.find((e=>e.id===n)).title,t={},a={},r=i.find((e=>e.id===n)).links;i.forEach((n=>{n.links.forEach((a=>{a===e&&(Object.keys(t).includes(n.title)||(t[n.title]=n.id))}))})),k(Object.entries(t)),i.forEach((e=>{r.includes(e.title)&&(a[e.title]=e.id)})),N(Object.entries(a))}}catch(e){console.log(e)}return()=>{}}),[i,n]);const P=Object(r.useState)([]),z=Object(u.a)(P,2),A=z[0],L=z[1];Object(r.useEffect)((()=>{let e={};return i.forEach((t=>{t.tags.forEach((t=>{Object.keys(e).includes(t)?e[t]+=1:e[t]=1}))})),L(Object.entries(e)),()=>{}}),[i]);const q=Object(r.useState)([]),M=Object(u.a)(q,2),G=(M[0],M[1]);Object(r.useEffect)((()=>(G("link"===g?y:A),()=>{})),[g,y,F,A]);const U=e=>{f(e)},Y=e=>{c.open(e),document.getElementsByClassName("input")[0]&&document.getElementsByClassName("input")[0].focus()};return Object(a.jsxs)("div",{className:Object(se.a)(e.root,{[e.rootShift]:b}),children:[Object(a.jsx)(m.a,{}),Object(a.jsx)("div",{className:e.sidebarWrapper,children:Object(a.jsx)(re.a,{color:"default","aria-label":"open drawer",onClick:()=>{h(!b)},classes:{root:e.nopad},disableRipple:!0,children:b?Object(a.jsx)($t.a,{}):Object(a.jsx)(Qt.a,{})})}),Object(a.jsxs)(ht.a,{className:e.drawer,variant:"persistent",anchor:"right",open:b,classes:{paper:e.drawerPaper,docked:e.drawerPaperWrapper},children:[Object(a.jsxs)("div",{style:{display:"flex"},children:[Object(a.jsx)(re.a,{color:"link"===g?"inherit":"default",onClick:()=>U("link"),classes:{root:e.drawerButton},disableRipple:!0,children:Object(a.jsx)(Zt.a,{})}),Object(a.jsx)(re.a,{color:"tag"===g?"inherit":"default",onClick:()=>U("tag"),classes:{root:e.drawerButton},disableRipple:!0,children:Object(a.jsx)(tn.a,{})})]}),Object(a.jsx)(ze.a,{style:{height:"3px"}}),Object(a.jsx)("div",{style:{flexGrow:1,overflowY:"auto"},children:Object(a.jsx)(yt.a,{disablePadding:!0,children:"tag"===g?A.map(((e,t)=>Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(kt.a,{button:!0,onClick:()=>{var t;t=e[0],o("tags: "+t),l(!0),d("search")},children:[Object(a.jsx)(Ct.a,{primary:"# "+e[0]}),Object(a.jsx)(Ct.a,{primary:e[1],style:{textAlign:"right"}})]},t),Object(a.jsx)(ze.a,{})]}))):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(kt.a,{button:!0,onClick:()=>W(!T),className:e.linksIOTitle,children:[T?Object(a.jsx)(Ft.a,{}):Object(a.jsx)(Et.a,{}),Object(a.jsx)(Ct.a,{primary:"Linked from..."})]},"inLinks"),Object(a.jsx)(ze.a,{}),T?y.map(((e,t)=>Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(kt.a,{button:!0,onClick:()=>{Y(e[1])},children:Object(a.jsx)(Ct.a,{primary:e[0]})},t),Object(a.jsx)(ze.a,{})]}))):null,Object(a.jsxs)(kt.a,{button:!0,onClick:()=>R(!D),className:e.linksIOTitle,children:[D?Object(a.jsx)(Ft.a,{}):Object(a.jsx)(Et.a,{}),Object(a.jsx)(Ct.a,{primary:"Link to..."})]},"outLinks"),Object(a.jsx)(ze.a,{}),D?F.map(((e,t)=>Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(kt.a,{button:!0,onClick:()=>{Y(e[1])},children:Object(a.jsx)(Ct.a,{primary:e[0]})},t),Object(a.jsx)(ze.a,{})]}))):null]})})})]})]})}var rn=n(1437),cn=n(1429);function sn(){const e=Object(F.a)(["\n    mutation addtag($id: String!, $email: String!, $tag: String!) {\n        addtag(id: $id, email: $email, tag: $tag)\n    }\n"]);return sn=function(){return e},e}const on=E()(sn());function ln(){const e=Object(F.a)(["\n    mutation deletetag($id: String!, $email: String!, $index: Int!) {\n        deletetag(id: $id, email: $email, index: $index)\n    }\n"]);return ln=function(){return e},e}const dn=E()(ln()),un=Object(y.a)((e=>({root:{display:"flex",flexWrap:"wrap",alignItems:"center",listStyle:"none",margin:0,height:"32px",overflowY:"auto"},chip:{margin:e.spacing(.5)},titlebar:{flexGrow:1,fontSize:"14px",margin:e.spacing(.5),outline:"none",padding:"1px 6px",borderRadius:"12px",borderColor:"".concat(e.palette.divider),"&:focus":{borderColor:e.palette.text.primary}},alert:{width:"256px"}})));function jn(){const e=un(),t=Object(r.useContext)(Ne),n=t.currentOpenFile,c=t.usernotes,s=t.setuserNotes,o=Object(r.useState)(null),j=Object(u.a)(o,2),p=j[0],b=j[1];i.a.useEffect((()=>{p&&setTimeout((function(){b(null)}),1300)}),[p]);const h=Boolean(p),x=h?"simple-popover":void 0,O=Object(r.useContext)(A),g=Object(S.a)(on),f=Object(u.a)(g,1)[0],v=Object(S.a)(dn),w=Object(u.a)(v,1)[0],y=Object(r.useState)(""),k=Object(u.a)(y,2),C=k[0],F=k[1],N=Object(r.useState)([]),E=Object(u.a)(N,2),I=E[0],T=E[1];Object(r.useEffect)((()=>(n&&c&&T(c.find((e=>e.id===n)).tags),()=>{})),[n,c]);const W=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=I.filter(((e,n)=>n!==t)),T(a),(r=[...c]).find((e=>e.id===n)).tags.splice(t,1),s(r),e.next=8,w({variables:{id:n,email:O.user.email,index:t}});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key||""===t.target.value||!n){e.next=18;break}if(e.prev=1,!I.includes(C)){e.next=5;break}return b(document.body),e.abrupt("return");case 5:return(a=[...c]).find((e=>e.id===n)).tags.push(C),s(a),T([...I,C]),t.target.value="",e.next=12,f({variables:{id:n,email:O.user.email,tag:C}});case 12:F(""),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(m.a,{}),Object(a.jsxs)("div",{className:e.root,children:[I.map(((t,n)=>Object(a.jsx)("li",{children:Object(a.jsx)(Ae.a,{size:"small",label:t,onDelete:()=>W(n),className:e.chip})},n))),Object(a.jsx)("input",{id:"taginput",className:e.titlebar,placeholder:"New tags",onChange:e=>{F(e.target.value)},onKeyDown:B}),Object(a.jsx)(rn.a,{id:x,open:h,anchorEl:p,onClose:()=>{b(null)},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(a.jsx)(cn.a,{className:e.alert,severity:"warning",children:"Tag Already Exists!"})})]})]})}function pn(){const e=Object(F.a)(["\n    mutation createNote(\n        $email: String!\n        $title: String!\n        $markdown: String!\n        $tags: [String]!\n        $links: [String]!\n    ) {\n        createNote(\n            data: {\n                email: $email\n                title: $title\n                markdown: $markdown\n                tags: $tags\n                links: $links\n            }\n        ) {\n            id\n            tags\n            title\n            markdown\n            links\n        }\n    }\n"]);return pn=function(){return e},e}const bn=E()(pn());function mn(){const e=Object(F.a)(["\n    mutation deleteNote($id: String!, $email: String!) {\n        deleteNote(id: $id, email: $email)\n    }\n"]);return mn=function(){return e},e}const hn=E()(mn());function xn(e,t){let n=[],a="";switch(t.type){case"SET":return t.updData;case"NEW":return{usernotes:[...e.usernotes,t.data],openFiles:[...e.openFiles,t.id],currentOpenFile:t.id};case"OPEN":return"root"===t.id?e:e.openFiles.includes(t.id)?Object(W.a)(Object(W.a)({},e),{},{currentOpenFile:t.id}):Object(W.a)(Object(W.a)({},e),{},{openFiles:[...e.openFiles,t.id],currentOpenFile:t.id});case"RENAME":return Object(W.a)(Object(W.a)({},e),{},{usernotes:t.data});case"DELETE":if(a=e.currentOpenFile,n=e.openFiles.filter((e=>e!==t.id)),t.id===e.currentOpenFile){let t=e.openFiles.indexOf(e.currentOpenFile);a=t>0?e.openFiles[t-1]:0===t&&e.openFiles.length>1?e.openFiles[1]:""}return Object(W.a)(Object(W.a)({},e),{},{usernotes:t.data,openFiles:n,currentOpenFile:a});case"CLOSE":if(a=e.currentOpenFile,n=e.openFiles.filter((e=>e!==t.id)),t.id===e.currentOpenFile){let t=e.openFiles.indexOf(e.currentOpenFile);a=t>0?e.openFiles[t-1]:0===t&&e.openFiles.length>1?e.openFiles[1]:""}return Object(W.a)(Object(W.a)({},e),{},{openFiles:n,currentOpenFile:a});default:return e}}var On=n(485),gn=n.n(On);var fn=({type:e,color:t})=>Object(a.jsx)(gn.a,{type:e,color:t,height:180,width:180});const vn=Object(y.a)((e=>({mainGrid:{marginTop:e.spacing(3)},pageContainer:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"}})));function wn(){const e=vn(),t=Object(r.useContext)(A).user,n=t.email,c=t.userId,s=Object(r.useState)("search"),o=Object(u.a)(s,2),j=o[0],p=o[1],b=Object(r.useState)(!1),h=Object(u.a)(b,2),x=h[0],O=h[1],g=Object(r.useState)(""),f=Object(u.a)(g,2),v=f[0],w=f[1],y=Object(S.b)(ut,{variables:{email:n}}),k=y.loading,C=y.error,F=y.data,N=Object(S.b)(pt,{variables:{id:c}}),E=N.loading,I=N.error,T=N.data,B=Object(r.useState)(""),$=Object(u.a)(B,2),D=$[0],R=$[1];Object(r.useEffect)((()=>(E||I||R(T.userAvatar),()=>{})),[E]);const P=Object(S.b)(mt),z=P.loading,L=P.error,q=P.data,M=Object(r.useState)(""),G=Object(u.a)(M,2),U=G[0],Y=G[1];Object(r.useEffect)((()=>(z||L||Y(q.user),()=>{})),[z]);const _=function(e){const t=Object(r.useReducer)(xn,e),n=Object(u.a)(t,2),a=n[0],i=n[1],c=Object(S.a)(bn),s=Object(u.a)(c,1)[0],o=Object(S.a)(hn),j=Object(u.a)(o,1)[0],p=Object(S.a)(it),b=Object(u.a)(p,1)[0],m=Object(r.useContext)(A).user.email;function h(e){i({type:"SET",updData:Object(W.a)(Object(W.a)({},a),{},{usernotes:e})})}function x(){return(x=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({variables:{email:m,title:t,markdown:"",tags:[],links:[]}});case 3:n=e.sent,i({type:"NEW",id:n.data.createNote.id,data:n.data.createNote}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function O(){return(O=Object(d.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=[...a.usernotes]).find((e=>e.id===t)).title=n,i({type:"RENAME",id:t,data:r}),e.next=6,b({variables:{id:t,email:m,title:n}});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function g(){return(g=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[...a.usernotes],r=n.findIndex((e=>e.id===t)),n.splice(r,1),i({type:"DELETE",id:t,data:n}),e.next=7,j({variables:{id:t,email:m}});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}return{usernotes:a.usernotes,openFiles:a.openFiles,currentOpenFile:a.currentOpenFile,setuserNotes:h,setopenFiles:function(e){i({type:"SET",updData:Object(W.a)(Object(W.a)({},a),{},{openFiles:e})})},setcurrentOpenFile:function(e){i({type:"SET",updData:Object(W.a)(Object(W.a)({},a),{},{currentOpenFile:e})})},actions:{new:function(e){return x.apply(this,arguments)},open:function(e){i({type:"OPEN",id:e})},save:function(e,t){let n=[...a.usernotes],r=n.findIndex((t=>t.id===e));n[r]=t,h(n)},close:function(e){i({type:"CLOSE",id:e})},rename:function(e,t){return O.apply(this,arguments)},delete:function(e){return g.apply(this,arguments)}}}}({usernotes:[],openFiles:[],currentOpenFile:""}),V=_.usernotes,H=_.openFiles,J=_.currentOpenFile,Q=_.setcurrentOpenFile,X=_.setuserNotes,Z=_.setopenFiles,ee=_.actions;return Object(r.useEffect)((()=>{k||C||X(F.usernotes)}),[k,F,C]),k||E||z?Object(a.jsx)("div",{backgroundColor:"blue",style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(a.jsx)(fn,{type:"spinningBubbles",color:"ffffff"})}):Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(K.a,{maxWidth:!1,disableGutters:!0,className:e.pageContainer,children:Object(a.jsxs)(Ne.Provider,{value:{usernotes:V,openFiles:H,currentOpenFile:J,setcurrentOpenFile:Q,setuserNotes:X,setopenFiles:Z,actions:ee},children:[Object(a.jsx)(ve.Provider,{value:{avatar:D,setAvatar:R},children:Object(a.jsx)(Re,{})}),Object(a.jsx)(st.Provider,{value:{mode:j,setMode:p,open:x,setOpen:O,searchStr:v,setSearchStr:w,guide:U},children:Object(a.jsxs)("main",{style:{display:"flex",flexGrow:1,width:"100vw",alignItems:"stretch"},children:[Object(a.jsx)(Ht,{}),Object(a.jsx)("div",{style:{display:"flex",flex:"1 1 0",minWidth:"0px",overflowY:"hidden"},children:Object(a.jsxs)("div",{style:{display:"flex",flexGrow:1,maxWidth:"100%",minWidth:"0px",flexDirection:"column",alignItems:"stretch"},children:[Object(a.jsx)(lt,{}),Object(a.jsx)(jn,{})]})}),Object(a.jsx)(an,{})]})})]})})]})}var yn=function(){return Object(a.jsxs)(j.d,{children:[Object(a.jsx)(te,{exact:!0,path:"/",component:_}),Object(a.jsx)(te,{exact:!0,path:"/login",component:_}),Object(a.jsx)(te,{exact:!0,path:"/signup",component:Z}),Object(a.jsx)(ne,{exact:!0,path:"/dashboard",component:wn})]})};var kn=function(){const e=Object(r.useState)(!0),t=Object(u.a)(e,2),n=t[0],i=t[1],c=Object(r.useContext)(A);return Object(r.useEffect)((()=>{fetch("/refresh_token",{method:"POST",credentials:"include"}).then(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r,s,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:(n=e.sent).accessToken?(R(n.accessToken),a=$()(n.accessToken),r=a.userId,s=a.name,o=a.email,c.user||c.login({userId:r,name:s,email:o,accessToken:n.accessToken})):console.log("no access Token, Please login"),i(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(x.a,{children:n?Object(a.jsx)("div",{backgroundColor:"blue",style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(a.jsx)(fn,{type:"spinningBubbles",color:"ffffff"})}):Object(a.jsx)(yn,{})})})};var Cn=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,1438)).then((({getCLS:t,getFID:n,getFCP:a,getLCP:r,getTTFB:i})=>{t(e),n(e),a(e),r(e),i(e)}))},Sn=n(164),Fn=n(1431),Nn=n(66),En=n(78),In=n(57),Tn=n(487),Wn=n(1426),Bn=n.n(Wn),$n=n(489);const Dn=Bn()({uri:"/graphql",credentials:"include"}),Rn=new En.a(((e,t)=>new In.a((n=>{let a;return Promise.resolve(e).then((e=>{const t=P();t&&e.setContext({headers:{authorization:"bearer ".concat(t)}})})).then((()=>{a=t(e).subscribe({next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)})})).catch(n.error.bind(n)),()=>{a&&a.unsubscribe()}})))),Pn=new $n.a({accessTokenField:"accessToken",isTokenValidOrUndefined:()=>{const e=P();if(!e)return!0;try{const t=$()(e).exp;return!(Date.now()>=1e3*t)}catch(t){return!1}},fetchAccessToken:()=>fetch("/refresh_token",{method:"POST",credentials:"include"}),handleFetch:e=>{R(e)},handleError:e=>{console.warn("Your refresh token is invalid. Try to relogin"),console.error(e)}}),zn=Object(Tn.a)((({graphQLErrors:e,networkError:t,errorMessage:n})=>{console.log(e),console.log(t)})),An=new Sn.a({link:En.a.from([Pn,zn,Rn,Dn]),cache:(new Fn.a).restore({})}),Ln=Object(a.jsx)(Nn.a,{client:An,children:Object(a.jsx)(q,{children:Object(a.jsx)(kn,{})})});s.a.render(Ln,document.getElementById("root")),Cn()},516:function(e,t,n){},518:function(e,t,n){}},[[1367,1,2]]]);
//# sourceMappingURL=main.3d53c618.chunk.js.map